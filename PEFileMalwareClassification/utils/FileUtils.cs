using PeNet;
using System;
using System.Collections.Generic;
using System.IO;

namespace PEFileMalwareClassification.utils
{
    internal class FileUtils
    {
        public static List<string> GetAllFiles(string path)
        {
            var files = new List<string>();
            if (File.Exists(path)) { files.Add(path); }
            else
            {
                try
                {
                    files.AddRange(Directory.GetFiles(path));
                    foreach (var directory in Directory.GetDirectories(path))
                    {
                        files.AddRange(GetAllFiles(directory));
                    }
                }
                catch (Exception ex)
                {
                    Console.WriteLine(ex.ToString());
                }
            }
            return files;
        }

        /// <summary>
        /// Kiểm tra file đó có phải là PE file hay không?
        /// </summary>
        /// <param name="path">Đường dẫn tới file cần kiểm tra (đã phải check tồn tại file)</param>
        /// <returns></returns>
        public static bool IsPeFile(string path)
        {
            return PeFile.IsPeFile(path); ;
        }
    }
}
